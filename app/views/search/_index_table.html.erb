<!-- InstanceBeginEditable name="Full Width Content" -->
<div id="DataTables_Table_0_wrapper" class="dataTables_wrapper form-inline" role="grid">
  <div class="row">
  
    <%= form_tag "search", :method => 'get', :id => 'simple_search', :class => "no-margin" do %>
    <div class="span6">
      <div id="DataTables_Table_0_length" class="dataTables_length">
      
      <label>
      <%= select_tag :DataTables_Table_0_length,
            options_for_select([['10', 10], ['25', 25], ['50', 50], ['100', 100]],
              params[:DataTables_Table_0_length] || WillPaginate.per_page),
              size: "1",
              "aria-controls" => "DataTables_Table_0"
          %> records per page
      </label>
      
      </div> <!-- id="DataTables_Table_0_length" -->
    </div> <!-- class="span6" -->
    
    <div class="span6">
      <div class="dataTables_filter" id="DataTables_Table_0_filter">
  			  <div style="height: 30px"><label>Search: <%= text_field_tag :search, params[:search] %></label></div>
          <%= hidden_field_tag :direction, params[:direction] %>
          <a href="<%= "#{request.fullpath}&format=csv" %>">Download&nbsp;Search&nbsp;Results</a>
          <%= hidden_field_tag :sort, params[:sort] %>
      </div> <!-- id="DataTables_Table_0_filter" -->
    </div> <!-- class="span6" -->
    <% end %>
	</div> <!-- class="row" -->          
  <table class="table table-striped table-bordered table-hover datatable dataTable" id="DataTables_Table_0" aria-describedby="DataTables_Table_0_info">
		  <thead>
	      <tr role="row">
          <!--                    <th>Author</th>
                                  <th>Year</th>-->
          <th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px"><%= sortable "traits_and_yields_view.sitename", "Site" %> <em>(City)</em></th>
          <!--                    <th>Date</th>-->
          <th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px">Latitude</th> 
          <th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px">Longitude</th> 
          <th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px"><%= sortable "traits_and_yields_view.scientificname", "Species" %></th>
          <!--                    <th>Treatment</th> -->
          <th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px"><%= sortable "traits_and_yields_view.trait", "Trait" %></th>
          <th class="sorting" role="columnheader" aria-controls="DataTables_Table_0" style="width: 100px">Mean</th>
          <!--                    <th>N</th>
                                  <th>SE</th>-->
      </tr>
    </thead>    
	  <tbody role="alert" aria-live="polite" aria-relevant="all">
	    <% @results.each do |t| %>
        <tr><!--<%
=begin
        <tr<%= " style='background-color:yellow'" if @search and !@search[/[^\d]/] and citation.id == @search.to_i%>>
<%
=end
%>
          <!--
              <%
=begin %>
          <td class="center"><%= t.author %></td>
          <td class="center"><%= t.year %></td>
          <%
=end %>
          -->
          <td class="center"><%= t.sitename %><%= if t.sitename && t.city &&
                                                  !t.sitename.strip.empty? && !t.city.strip.empty?
                                                  then raw("<br>") end
                                                  %><%= if t.city && !t.city.strip.empty?
                                                        then raw("<em>(#{t.city})</em>") end %></td>
          <!--
              <%
=begin %>
          <td class="center"><%= if t.dateloc < 5 then
                                 t.date
                                 elsif t.dateloc < 8
                                                   t.year
                                                   else
                                                   "-"
                                                   end %></td>
                                 <%
=end %>
                                 -->
          <td class="center"><%= t.lat ? t.lat.round(2) : nil  %></td>
          <td class="center"><%= t.lon ? t.lon.round(2) : nil %></td>
          <td class="center"><em><%= t.scientificname.to_s %></em>
            <%= if t.commonname && !t.commonname.strip.blank? then raw("<br>(" + t.commonname.strip + ")") end %>
          </td>
          <td class="center"><%= t.trait %><br>(<%= t.trait_description %>)</td>
          <!--
              <%
=begin %>
          <td class="center"><%= t.treatment  %></td>
          <%
=end %>
          -->
          <% require 'float' %>
          <td class="center"><%= "#{t.mean.to_f.round_to_significant_digit(3).pretty_s} #{t.units}"  %></td>
          <!--
              <%
=begin %>
          <td class="center"><%= t.n %></td>
          <td class="center"><%= if t.statname == "SE" then t.stat
                  elsif t.statname == "SD" then t.stat/Math.sqrt(t.n) 
                  else "-"
                  end
                  %></td>
          <%
=end %>
          -->
        </tr>
      <% end %>

	  </tbody>
	</table>
  
	<div class="row final_paginate_row">
	  <div class="span6">
	    <div class="dataTables_info" id="DataTables_Table_0_info">
	      <%= page_entries_info @results %>
	    </div>
	  </div>
	  <div class="span6">
	    <div class="dataTables_paginate paging_bootstrap pagination alternate">
        <%= will_paginate @results %>
      </div>
    </div>
  </div>
</div>
