
<table>
<% params.each do |p| %>
<tr><td><%= p[0] %></td><td><%= p[1] %></td></tr>
<% end %>
</table>

<%= form_tag({ action: "map_data" }) do %>
<style>
  .red { background-color: #f00 }
  .green { background-color: #0f0 }
  .gray { background-color: #aaa }
</style>
<table>
  <thead>
    <tr>
      <% @displayed_columns.each do |column| %>
      <th><%= column.name %></th>
      <% end %>
    </tr>
  </thead>
  <tbody id="insert_data">
    <% @data.each do |row| %>
    <tr>
      <%# Iterate through the database table columns and show the value that will be inserted for each column in this row. %>
      <% @displayed_columns.each do |column| %>
      <td class="<%= validate(column.name, row.to_hash[column.name] || params[column.name]) %>"><%= row.to_hash[params["mapping"]["source_column"][column.name]] || params["mapping"]["value"][column.name] || (column.default.nil? ? "NULL" : column.default) %></td>
      <% end %>
    </tr>
  <% end %>
  </tbody>
</table>
<%= submit_tag("Confirm data table") %>
<% end %>
