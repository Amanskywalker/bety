<script type="text/javascript">
//<![CDATA[

var marker = [];
function addMarkers() {
    
<% @all_marker_locations.each do |site| %>

    var point = new google.maps.LatLng(<%= site.lat %>,<%= site.lon %>);
    marker[<%= site.site_id -%>] = new google.maps.Marker({
        position: point,
        title: "<%= raw (site.sitename || site.city || '') %>",
        map: map,
        icon: {
            url: "images/whiteball.png",
            anchor: new google.maps.Point(7, 7)
        }
    });
    google.maps.event.addListener(marker[<%= site.site_id -%>], "click", searchBySite);
    
<% end %>

<% @map_selected_sites_excluded_by_search_terms.each do |site| %>
    marker[<%= site["site_id"] %>].setIcon("images/yellowball.png");
<% end %>

<% @all_result_locations.each do |site| %>
    marker[<%= site["site_id"] %>].setIcon("images/redball.png");
<% end %>

}

//]]>
</script>
